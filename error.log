{"level":"error","message":"Error al procesar mensaje: Unexpected end of JSON input","stack":"SyntaxError: Unexpected end of JSON input\n    at JSON.parse (<anonymous>)\n    at Encryption.decrypt (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\src\\utils\\encryption.ts:18:17)\n    at WebSocket.<anonymous> (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\src\\transport\\WebSocketTransport.ts:84:50)\n    at WebSocket.emit (node:events:518:28)\n    at WebSocket.emit (node:domain:489:12)\n    at Receiver.receiverOnMessage (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\node_modules\\ws\\lib\\websocket.js:1220:20)\n    at Receiver.emit (node:events:518:28)\n    at Receiver.emit (node:domain:489:12)\n    at Receiver.dataMessage (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\node_modules\\ws\\lib\\receiver.js:596:14)\n    at Receiver.getData (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\node_modules\\ws\\lib\\receiver.js:496:10)","timestamp":"2025-05-21T22:09:13.224Z"}
{"level":"error","message":"Error al procesar mensaje: Unexpected end of JSON input","stack":"SyntaxError: Unexpected end of JSON input\n    at JSON.parse (<anonymous>)\n    at Encryption.decrypt (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\src\\utils\\encryption.ts:18:17)\n    at WebSocket.<anonymous> (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\src\\transport\\WebSocketTransport.ts:84:50)\n    at WebSocket.emit (node:events:518:28)\n    at WebSocket.emit (node:domain:489:12)\n    at Receiver.receiverOnMessage (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\node_modules\\ws\\lib\\websocket.js:1220:20)\n    at Receiver.emit (node:events:518:28)\n    at Receiver.emit (node:domain:489:12)\n    at Receiver.dataMessage (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\node_modules\\ws\\lib\\receiver.js:596:14)\n    at Receiver.getData (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\node_modules\\ws\\lib\\receiver.js:496:10)","timestamp":"2025-05-21T22:09:13.230Z"}
{"level":"error","message":"Escritor Creativo - Error en WebSocket:","timestamp":"2025-05-21T22:10:29.943Z"}
{"code":"ERR_INVALID_ARG_TYPE","level":"error","message":"Error al desencriptar mensaje: The first argument must be of type string or an instance of Buffer, ArrayBuffer, or Array or an Array-like Object. Received undefined","stack":"TypeError: The first argument must be of type string or an instance of Buffer, ArrayBuffer, or Array or an Array-like Object. Received undefined\n    at Function.from (node:buffer:320:9)\n    at Encryption.decrypt (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\src\\utils\\encryption.ts:41:24)\n    at WebSocket.<anonymous> (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\src\\transport\\WebSocketTransport.ts:68:51)\n    at WebSocket.emit (node:events:518:28)\n    at WebSocket.emit (node:domain:489:12)\n    at Receiver.receiverOnMessage (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\node_modules\\ws\\lib\\websocket.js:1220:20)\n    at Receiver.emit (node:events:518:28)\n    at Receiver.emit (node:domain:489:12)\n    at Receiver.dataMessage (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\node_modules\\ws\\lib\\receiver.js:596:14)\n    at Receiver.getData (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\node_modules\\ws\\lib\\receiver.js:496:10)","timestamp":"2025-05-21T22:12:29.834Z"}
{"level":"error","message":"Error al desencriptar mensaje: Error al desencriptar mensaje","stack":"Error: Error al desencriptar mensaje\n    at Encryption.decrypt (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\src\\utils\\encryption.ts:52:19)\n    at WebSocket.<anonymous> (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\src\\transport\\WebSocketTransport.ts:68:51)\n    at WebSocket.emit (node:events:518:28)\n    at WebSocket.emit (node:domain:489:12)\n    at Receiver.receiverOnMessage (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\node_modules\\ws\\lib\\websocket.js:1220:20)\n    at Receiver.emit (node:events:518:28)\n    at Receiver.emit (node:domain:489:12)\n    at Receiver.dataMessage (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\node_modules\\ws\\lib\\receiver.js:596:14)\n    at Receiver.getData (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\node_modules\\ws\\lib\\receiver.js:496:10)\n    at Receiver.startLoop (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\node_modules\\ws\\lib\\receiver.js:167:16)","timestamp":"2025-05-21T22:12:29.836Z"}
{"code":"ERR_INVALID_ARG_TYPE","level":"error","message":"Error al desencriptar mensaje: The first argument must be of type string or an instance of Buffer, ArrayBuffer, or Array or an Array-like Object. Received undefined","stack":"TypeError: The first argument must be of type string or an instance of Buffer, ArrayBuffer, or Array or an Array-like Object. Received undefined\n    at Function.from (node:buffer:320:9)\n    at Encryption.decrypt (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\src\\utils\\encryption.ts:41:24)\n    at WebSocket.<anonymous> (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\src\\transport\\WebSocketTransport.ts:68:51)\n    at WebSocket.emit (node:events:518:28)\n    at WebSocket.emit (node:domain:489:12)\n    at Receiver.receiverOnMessage (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\node_modules\\ws\\lib\\websocket.js:1220:20)\n    at Receiver.emit (node:events:518:28)\n    at Receiver.emit (node:domain:489:12)\n    at Receiver.dataMessage (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\node_modules\\ws\\lib\\receiver.js:596:14)\n    at Receiver.getData (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\node_modules\\ws\\lib\\receiver.js:496:10)","timestamp":"2025-05-21T22:12:29.843Z"}
{"level":"error","message":"Error al desencriptar mensaje: Error al desencriptar mensaje","stack":"Error: Error al desencriptar mensaje\n    at Encryption.decrypt (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\src\\utils\\encryption.ts:52:19)\n    at WebSocket.<anonymous> (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\src\\transport\\WebSocketTransport.ts:68:51)\n    at WebSocket.emit (node:events:518:28)\n    at WebSocket.emit (node:domain:489:12)\n    at Receiver.receiverOnMessage (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\node_modules\\ws\\lib\\websocket.js:1220:20)\n    at Receiver.emit (node:events:518:28)\n    at Receiver.emit (node:domain:489:12)\n    at Receiver.dataMessage (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\node_modules\\ws\\lib\\receiver.js:596:14)\n    at Receiver.getData (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\node_modules\\ws\\lib\\receiver.js:496:10)\n    at Receiver.startLoop (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\node_modules\\ws\\lib\\receiver.js:167:16)","timestamp":"2025-05-21T22:12:29.844Z"}
{"code":"ERR_INVALID_ARG_TYPE","level":"error","message":"Error al desencriptar mensaje: The first argument must be of type string or an instance of Buffer, ArrayBuffer, or Array or an Array-like Object. Received undefined","stack":"TypeError: The first argument must be of type string or an instance of Buffer, ArrayBuffer, or Array or an Array-like Object. Received undefined\n    at Function.from (node:buffer:320:9)\n    at Encryption.decrypt (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\src\\utils\\encryption.ts:41:24)\n    at WebSocket.<anonymous> (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\src\\transport\\WebSocketTransport.ts:62:51)\n    at WebSocket.emit (node:events:518:28)\n    at WebSocket.emit (node:domain:489:12)\n    at Receiver.receiverOnMessage (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\node_modules\\ws\\lib\\websocket.js:1220:20)\n    at Receiver.emit (node:events:518:28)\n    at Receiver.emit (node:domain:489:12)\n    at Receiver.dataMessage (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\node_modules\\ws\\lib\\receiver.js:596:14)\n    at Receiver.getData (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\node_modules\\ws\\lib\\receiver.js:496:10)","timestamp":"2025-05-21T22:13:08.407Z"}
{"level":"error","message":"Error al procesar mensaje: Error al desencriptar mensaje","stack":"Error: Error al desencriptar mensaje\n    at Encryption.decrypt (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\src\\utils\\encryption.ts:52:19)\n    at WebSocket.<anonymous> (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\src\\transport\\WebSocketTransport.ts:62:51)\n    at WebSocket.emit (node:events:518:28)\n    at WebSocket.emit (node:domain:489:12)\n    at Receiver.receiverOnMessage (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\node_modules\\ws\\lib\\websocket.js:1220:20)\n    at Receiver.emit (node:events:518:28)\n    at Receiver.emit (node:domain:489:12)\n    at Receiver.dataMessage (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\node_modules\\ws\\lib\\receiver.js:596:14)\n    at Receiver.getData (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\node_modules\\ws\\lib\\receiver.js:496:10)\n    at Receiver.startLoop (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\node_modules\\ws\\lib\\receiver.js:167:16)","timestamp":"2025-05-21T22:13:08.409Z"}
{"code":"ERR_INVALID_ARG_TYPE","level":"error","message":"Error al desencriptar mensaje: The first argument must be of type string or an instance of Buffer, ArrayBuffer, or Array or an Array-like Object. Received undefined","stack":"TypeError: The first argument must be of type string or an instance of Buffer, ArrayBuffer, or Array or an Array-like Object. Received undefined\n    at Function.from (node:buffer:320:9)\n    at Encryption.decrypt (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\src\\utils\\encryption.ts:41:24)\n    at WebSocket.<anonymous> (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\src\\transport\\WebSocketTransport.ts:62:51)\n    at WebSocket.emit (node:events:518:28)\n    at WebSocket.emit (node:domain:489:12)\n    at Receiver.receiverOnMessage (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\node_modules\\ws\\lib\\websocket.js:1220:20)\n    at Receiver.emit (node:events:518:28)\n    at Receiver.emit (node:domain:489:12)\n    at Receiver.dataMessage (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\node_modules\\ws\\lib\\receiver.js:596:14)\n    at Receiver.getData (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\node_modules\\ws\\lib\\receiver.js:496:10)","timestamp":"2025-05-21T22:13:08.417Z"}
{"level":"error","message":"Error al procesar mensaje: Error al desencriptar mensaje","stack":"Error: Error al desencriptar mensaje\n    at Encryption.decrypt (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\src\\utils\\encryption.ts:52:19)\n    at WebSocket.<anonymous> (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\src\\transport\\WebSocketTransport.ts:62:51)\n    at WebSocket.emit (node:events:518:28)\n    at WebSocket.emit (node:domain:489:12)\n    at Receiver.receiverOnMessage (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\node_modules\\ws\\lib\\websocket.js:1220:20)\n    at Receiver.emit (node:events:518:28)\n    at Receiver.emit (node:domain:489:12)\n    at Receiver.dataMessage (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\node_modules\\ws\\lib\\receiver.js:596:14)\n    at Receiver.getData (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\node_modules\\ws\\lib\\receiver.js:496:10)\n    at Receiver.startLoop (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\node_modules\\ws\\lib\\receiver.js:167:16)","timestamp":"2025-05-21T22:13:08.420Z"}
{"level":"error","message":"StoryWriterAgent - Error al generar la historia: Cannot read properties of undefined (reading 'create')","stack":"TypeError: Cannot read properties of undefined (reading 'create')\n    at StoryWriterAgent.handleBroadcast (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\src\\agents\\StoryWriterAgent.ts:133:71)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async StoryWriterAgent.handleMessage (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\src\\agents\\BaseAIAgent.ts:145:21)\n    at async WebSocket.<anonymous> (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\src\\agents\\BaseAIAgent.ts:69:25)","timestamp":"2025-05-21T22:33:45.124Z"}
{"level":"error","message":"StoryWriterAgent - Error al generar la historia: Cannot read properties of undefined (reading 'create')","stack":"TypeError: Cannot read properties of undefined (reading 'create')\n    at StoryWriterAgent.handleBroadcast (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\src\\agents\\StoryWriterAgent.ts:133:71)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async StoryWriterAgent.handleMessage (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\src\\agents\\BaseAIAgent.ts:145:21)\n    at async WebSocket.<anonymous> (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\src\\agents\\BaseAIAgent.ts:69:25)","timestamp":"2025-05-21T22:35:34.351Z"}
{"level":"error","message":"Escritor Creativo - No se pudo enviar el mensaje: WebSocket no está abierto","timestamp":"2025-05-21T22:59:41.389Z"}
{"level":"error","message":"Escritor Creativo - Error al procesar mensaje: Agente con ID escritor-ia no está registrado","stack":"Error: Agente con ID escritor-ia no está registrado\n    at WebSocketTransport.updateAgentStatus (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\src\\transport\\WebSocketTransport.ts:180:19)\n    at StoryWriterAgent.updateStatus (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\src\\agents\\BaseAIAgent.ts:179:30)\n    at StoryWriterAgent.handleBroadcast (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\src\\agents\\StoryWriterAgent.ts:191:28)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async StoryWriterAgent.handleMessage (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\src\\agents\\BaseAIAgent.ts:145:21)\n    at async StoryWriterAgent.agent.handleMessage (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\examples\\ai-story-collaboration.ts:77:13)\n    at async WebSocket.<anonymous> (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\src\\agents\\BaseAIAgent.ts:69:25)","timestamp":"2025-05-21T22:59:41.396Z"}
{"level":"error","message":"StoryWriterAgent - Error al generar historia: stepModel.doGenerate is not a function","stack":"TypeError: stepModel.doGenerate is not a function\n    at fn (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\node_modules\\ai\\core\\generate-text\\generate-text.ts:402:46)\n    at C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\node_modules\\ai\\core\\telemetry\\record-span.ts:18:28\n    at Object.startActiveSpan (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\node_modules\\ai\\core\\telemetry\\noop-tracer.ts:21:14)\n    at recordSpan (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\node_modules\\ai\\core\\telemetry\\record-span.ts:16:17)\n    at C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\node_modules\\ai\\core\\generate-text\\generate-text.ts:359:11\n    at _retryWithExponentialBackoff (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\node_modules\\ai\\util\\retry-with-exponential-backoff.ts:36:18)\n    at C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\node_modules\\ai\\util\\retry-with-exponential-backoff.ts:20:5\n    at fn (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\node_modules\\ai\\core\\generate-text\\generate-text.ts:358:38)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\node_modules\\ai\\core\\telemetry\\record-span.ts:18:22","timestamp":"2025-05-21T23:09:52.630Z"}
{"isRetryable":false,"level":"error","message":"StoryWriterAgent - Error al generar historia: Not Found","name":"AI_APICallError","requestBodyValues":{"messages":[{"content":"Eres un escritor creativo especializado en crear historias cortas para niños. Tu tarea es crear una historia interesante, educativa y cautivadora que transmita valores positivos.","role":"system"},{"content":"Crea una historia corta sobre aventura en el bosque que enseñe sobre amistad y trabajo en equipo.","role":"user"}],"model":"gpt-4o","temperature":0},"responseBody":"{\"detail\":\"Invalid model format or unknown provider: gpt-4o. Expected format: 'provider-X/model-name'\"}","responseHeaders":{"connection":"keep-alive","content-length":"103","content-type":"application/json","date":"Wed, 21 May 2025 23:11:46 GMT","server":"nginx/1.24.0 (Ubuntu)"},"stack":"AI_APICallError: Not Found\n    at C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\node_modules\\@ai-sdk\\provider-utils\\src\\response-handler.ts:73:16\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async postToApi (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\node_modules\\@ai-sdk\\provider-utils\\src\\post-to-api.ts:111:28)\n    at async OpenAIChatLanguageModel.doGenerate (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\node_modules\\@ai-sdk\\openai\\src\\openai-chat-language-model.ts:379:9)\n    at async fn (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\node_modules\\ai\\core\\generate-text\\generate-text.ts:402:30)\n    at async C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\node_modules\\ai\\core\\telemetry\\record-span.ts:18:22\n    at async _retryWithExponentialBackoff (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\node_modules\\ai\\util\\retry-with-exponential-backoff.ts:36:12)\n    at async fn (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\node_modules\\ai\\core\\generate-text\\generate-text.ts:358:32)\n    at async C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\node_modules\\ai\\core\\telemetry\\record-span.ts:18:22\n    at async StoryWriterAgent.generarHistoria (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\src\\agents\\StoryWriterAgent.ts:23:28)","statusCode":404,"timestamp":"2025-05-21T23:11:49.492Z","url":"https://api.devsdocode.com/v1/chat/completions"}
{"level":"error","message":"Error en el proceso: Tiempo de espera agotado","stack":"Error: Tiempo de espera agotado\n    at main (C:\\Users\\Aurik3\\Desktop\\Nueva carpeta (3)\\examples\\ai-story-collaboration.ts:72:23)","timestamp":"2025-05-21T23:12:18.556Z"}
