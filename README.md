# AI Agents Collaboration Network

Una librer√≠a TypeScript para crear y conectar agentes de inteligencia artificial en una red colaborativa, permitiendo la comunicaci√≥n y colaboraci√≥n entre m√∫ltiples agentes especializados.

## üöÄ Caracter√≠sticas

- üîÑ Comunicaci√≥n en tiempo real entre agentes
- üîí Sistema de autenticaci√≥n y encriptaci√≥n
- üì° Transporte WebSocket para comunicaci√≥n bidireccional
- ü§ñ Soporte para m√∫ltiples tipos de agentes
- üìù Sistema de mensajer√≠a as√≠ncrono
- üåê Broadcast de mensajes a toda la red
- üìä Gesti√≥n de capacidades y estados de agentes
- üõ°Ô∏è Tipado fuerte con TypeScript

## üì¶ Instalaci√≥n

```bash
npm install ai-agents-collaboration
```

## üîß Requisitos

- Node.js >= 14.x
- TypeScript >= 4.x
- Dependencias principales:
  - ws
  - jsonwebtoken
  - crypto-js
  - dotenv
  - winston

## üéØ Uso B√°sico

### 1. Configuraci√≥n Inicial

```typescript
import { WebSocketTransport } from 'ai-agents-collaboration/transport';
import { Encryption } from 'ai-agents-collaboration/utils/encryption';
import { Authentication } from 'ai-agents-collaboration/utils/auth';
import { Agent, AgentStatus, AgentCapability } from 'ai-agents-collaboration/types';

// Configuraci√≥n de seguridad
const encryption = new Encryption('tu-clave-encryption');
const auth = new Authentication('tu-clave-auth');
const transport = new WebSocketTransport(0, 'tu-clave-encryption', 'tu-clave-auth');

// Iniciar el servidor
await transport.listen();
```

### 2. Crear un Agente

```typescript
const miAgente: Agent = {
    id: 'mi-agente-unico',
    name: 'Mi Agente Especializado',
    capabilities: [
        AgentCapability.TEXT_PROCESSING,
        AgentCapability.DATA_ANALYSIS,
        AgentCapability.COLLABORATION
    ],
    metadata: { 
        version: '1.0',
        model: 'GPT-4',
        specializations: ['tu especializaci√≥n']
    },
    status: AgentStatus.ONLINE
};

// Registrar el agente
const token = auth.generateToken(miAgente);
await transport.registerAgent(miAgente, token);
```

### 3. Enviar y Recibir Mensajes

```typescript
// Enviar un mensaje broadcast
const mensaje: Message = {
    id: 'msg-1',
    senderId: miAgente.id,
    receiverId: 'all',
    type: MessageType.BROADCAST,
    content: {
        action: 'procesar_tarea',
        data: {
            descripcion: 'Descripci√≥n de la tarea',
            requisitos: ['requisito1', 'requisito2']
        }
    },
    timestamp: Date.now(),
    priority: MessagePriority.HIGH,
    encryption: true
};

await transport.broadcast(mensaje);

// Escuchar mensajes
transport.on('message', async (message: Message) => {
    switch (message.type) {
        case MessageType.TASK_COMPLETION:
            console.log('‚úÖ Tarea completada:', message.content);
            break;
        case MessageType.ERROR:
            console.error('‚ùå Error:', message.content.error);
            break;
    }
});
```

## üîê Configuraci√≥n de Seguridad

### Variables de Entorno

Crea un archivo `.env` en la ra√≠z de tu proyecto:

```env
ENCRYPTION_KEY=tu-clave-encryption-secreta
AUTH_KEY=tu-clave-auth-secreta
```

### Generaci√≥n de Claves

```typescript
const auth = new Authentication();
const encryptionKey = auth.generateSecretKey();
const authKey = auth.generateSecretKey();
```

## üìö Tipos de Mensajes

- `REQUEST`: Solicitud directa a un agente
- `RESPONSE`: Respuesta a una solicitud
- `BROADCAST`: Mensaje para todos los agentes
- `TASK_COMPLETION`: Notificaci√≥n de tarea completada
- `ERROR`: Mensaje de error
- `STATUS_UPDATE`: Actualizaci√≥n de estado
- `COLLABORATION_REQUEST`: Solicitud de colaboraci√≥n

## üîÑ Manejo de Reconexiones

```typescript
transport.on('disconnect', async () => {
    console.log('üîÑ Reconectando...');
    await new Promise(resolve => setTimeout(resolve, 5000));
    await transport.listen();
    await transport.registerAgent(miAgente, token);
});
```

## üìä Monitoreo y Logging

La librer√≠a utiliza Winston para el logging. Los logs se guardan en:
- `error.log`: Errores
- `combined.log`: Todos los logs

## üß™ Ejemplos

La librer√≠a incluye varios ejemplos en el directorio `examples/`:

- `basic-usage.ts`: Uso b√°sico de la librer√≠a
- `ai-collaboration.ts`: Ejemplo de colaboraci√≥n entre agentes
- `story-collaboration.ts`: Ejemplo de creaci√≥n colaborativa de historias

Para ejecutar los ejemplos:

```bash
npm run example
npm run example:ai
npm run example:story
```
## üåê Configuraci√≥n de Red Distribuida

Esta secci√≥n explica c√≥mo configurar una red de agentes distribuida, permitiendo que agentes en diferentes redes se comuniquen entre s√≠.

### 1. Configuraci√≥n del Servidor Central (Network Hub)

El servidor central act√∫a como punto de conexi√≥n para todos los agentes. Debe estar accesible desde internet.

```typescript
// server.ts
import { WebSocketTransport } from 'ai-agents-collaboration/transport';
import { Encryption } from 'ai-agents-collaboration/utils/encryption';
import { Authentication } from 'ai-agents-collaboration/utils/auth';
import { config } from 'dotenv';

config();

async function iniciarServidor() {
    try {
        // Configuraci√≥n del servidor
        const encryption = new Encryption(process.env.ENCRYPTION_KEY || 'clave-encryption-secreta');
        const auth = new Authentication(process.env.AUTH_KEY || 'clave-auth-secreta');
        
        // El puerto 8080 debe estar abierto en el firewall y configurado en el router
        const transport = new WebSocketTransport(8080, process.env.ENCRYPTION_KEY || 'clave-encryption-secreta', process.env.AUTH_KEY || 'clave-auth-secreta');
        
        // Iniciar el servidor
        await transport.listen();
        
        const port = transport.getPort();
        console.log(`
üöÄ Servidor de Red de Agentes iniciado
------------------------------------
üì° Puerto: ${port}
üîí Encriptaci√≥n: Activada
üîë Autenticaci√≥n: Activada
üåê URL de conexi√≥n: ws://tu-ip-publica:${port}
        `);

        // Manejar conexiones de agentes
        transport.on('connection', (agentId) => {
            console.log(`\nüì• Nuevo agente conectado: ${agentId}`);
        });

        // Manejar desconexiones
        transport.on('disconnection', (agentId) => {
            console.log(`\nüì§ Agente desconectado: ${agentId}`);
        });

    } catch (error) {
        console.error('‚ùå Error al iniciar el servidor:', error);
        process.exit(1);
    }
}

iniciarServidor();
```

### 2. Configuraci√≥n del Agente Remoto (Cliente)

Los agentes remotos se conectan al servidor central desde cualquier ubicaci√≥n en internet.

```typescript
// remote-agent.ts
import { WebSocketTransport } from 'ai-agents-collaboration/transport';
import { Encryption } from 'ai-agents-collaboration/utils/encryption';
import { Authentication } from 'ai-agents-collaboration/utils/auth';
import { Agent, AgentStatus, AgentCapability, MessageType, MessagePriority, Message } from 'ai-agents-collaboration/types';
import { config } from 'dotenv';

config();

class AgenteRemoto {
    private transport: WebSocketTransport;
    private agent: Agent;
    private token: string;

    constructor() {
        // Configuraci√≥n del cliente
        const encryption = new Encryption(process.env.ENCRYPTION_KEY || 'clave-encryption-secreta');
        const auth = new Authentication(process.env.AUTH_KEY || 'clave-auth-secreta');
        
        // Crear el agente
        this.agent = {
            id: 'agente-remoto-1',
            name: 'Agente Remoto Especializado',
            capabilities: [
                AgentCapability.TEXT_PROCESSING,
                AgentCapability.DATA_ANALYSIS,
                AgentCapability.COLLABORATION
            ],
            metadata: { 
                version: '1.0',
                model: 'GPT-4',
                specializations: ['an√°lisis de datos', 'procesamiento de texto']
            },
            status: AgentStatus.OFFLINE
        };

        // Configurar el transporte para conectarse al servidor remoto
        this.transport = new WebSocketTransport(
            0, // Puerto local (se asignar√° autom√°ticamente)
            process.env.ENCRYPTION_KEY || 'clave-encryption-secreta',
            process.env.AUTH_KEY || 'clave-auth-secreta'
        );

        // Generar token de autenticaci√≥n
        this.token = auth.generateToken(this.agent);
    }

    async conectar() {
        try {
            console.log('\nüîÑ Conectando al servidor de red...');
            
            // Conectar al servidor remoto
            await this.transport.connect(`ws://tu-ip-publica:8080`);
            
            // Registrar el agente
            await this.transport.registerAgent(this.agent, this.token);
            
            console.log('‚úÖ Agente registrado exitosamente');

            // Configurar manejadores de eventos
            this.configurarManejadores();

        } catch (error) {
            console.error('‚ùå Error al conectar:', error);
            throw error;
        }
    }

    // ... resto de la implementaci√≥n del agente ...
}
```

### 3. Configuraci√≥n de Red

#### En el Servidor:

1. **Firewall:**
   - Abre el puerto 8080 (o el que hayas elegido) en el firewall
   - Aseg√∫rate de que el tr√°fico entrante est√© permitido

2. **Router:**
   - Configura el port forwarding:
     ```
     Puerto Externo: 8080 -> Puerto Interno: 8080
     IP Interna: [IP-local-del-servidor]
     ```

3. **Variables de Entorno:**
   ```env
   # .env en el servidor
   ENCRYPTION_KEY=tu-clave-encryption-secreta
   AUTH_KEY=tu-clave-auth-secreta
   ```

#### En los Agentes Remotos:

1. **Variables de Entorno:**
   ```env
   # .env en los agentes remotos
   ENCRYPTION_KEY=tu-clave-encryption-secreta
   AUTH_KEY=tu-clave-auth-secreta
   SERVER_URL=ws://tu-ip-publica:8080
   ```

2. **Conexi√≥n:**
   - Aseg√∫rate de que el agente pueda acceder al puerto 8080 del servidor
   - Verifica que la URL del servidor sea correcta

### 4. Ejecuci√≥n

1. **Iniciar el Servidor:**
   ```bash
   # En la m√°quina servidor
   npm run start:server
   ```

2. **Iniciar Agentes Remotos:**
   ```bash
   # En las m√°quinas cliente
   npm run start:agent
   ```

### 5. Verificaci√≥n

#### Servidor:
```
üöÄ Servidor de Red de Agentes iniciado
------------------------------------
üì° Puerto: 8080
üîí Encriptaci√≥n: Activada
üîë Autenticaci√≥n: Activada
üåê URL de conexi√≥n: ws://tu-ip-publica:8080
```

#### Agente Remoto:
```
üîÑ Conectando al servidor de red...
‚úÖ Agente registrado exitosamente
```

#### Servidor (cuando se conecta un agente):
```
üì• Nuevo agente conectado: agente-remoto-1
```

### 6. Consideraciones de Seguridad

1. **Encriptaci√≥n:**
   - Usa claves de encriptaci√≥n fuertes
   - Cambia las claves regularmente
   - No compartas las claves en repositorios p√∫blicos

2. **Autenticaci√≥n:**
   - Implementa un sistema de tokens robusto
   - Valida las credenciales de los agentes
   - Limita el acceso a agentes autorizados

3. **Firewall:**
   - Limita el acceso solo a los puertos necesarios
   - Implementa reglas de firewall estrictas
   - Monitorea el tr√°fico de red

4. **SSL/TLS:**
   - Considera usar WSS (WebSocket Secure) para conexiones encriptadas
   - Configura certificados SSL v√°lidos
   - Mant√©n los certificados actualizados

### 7. Soluci√≥n de Problemas

1. **Conexi√≥n Rechazada:**
   - Verifica que el puerto est√© abierto en el firewall
   - Confirma que el port forwarding est√© configurado correctamente
   - Aseg√∫rate de que la IP p√∫blica sea accesible

2. **Errores de Autenticaci√≥n:**
   - Verifica que las claves de encriptaci√≥n coincidan
   - Confirma que los tokens sean v√°lidos
   - Revisa los logs de autenticaci√≥n

3. **Problemas de Red:**
   - Verifica la conectividad de red
   - Comprueba la latencia
   - Monitorea el uso de ancho de banda 

## ü§ù Contribuir

Las contribuciones son bienvenidas. Por favor:

1. Haz fork del repositorio
2. Crea una rama para tu feature (`git checkout -b feature/AmazingFeature`)
3. Commit tus cambios (`git commit -m 'Add some AmazingFeature'`)
4. Push a la rama (`git push origin feature/AmazingFeature`)
5. Abre un Pull Request

## üìÑ Licencia

Este proyecto est√° bajo la Licencia MIT - ver el archivo [LICENSE](LICENSE) para m√°s detalles.

## üìû Soporte

Si encuentras alg√∫n problema o tienes alguna pregunta, por favor:

1. Revisa la [documentaci√≥n](docs/)
2. Abre un [issue](https://github.com/tu-usuario/ai-agents-collaboration/issues)
3. Contacta al equipo de soporte

## üôè Agradecimientos

- OpenAI por GPT-4
- La comunidad de TypeScript
- Todos los contribuidores 